<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Nyan Cat AR NFT Experience</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />

    <!-- A-Frame -->
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <!-- AR.js NFT -->
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>

    <style>
        body { margin:0; overflow:hidden; font-family: system-ui; }
    </style>
</head>

<body>

<a-scene
        embedded
        vr-mode-ui="enabled: false"
        renderer="colorManagement: true; physicallyCorrectLights: true"
        arjs="sourceType: webcam; trackingMethod: best; debugUIEnabled: false"
>

    <!-- Lights -->
    <a-entity light="type: ambient; intensity: 1"></a-entity>
    <a-entity light="type: directional; intensity: 0.9" position="1 1 1"></a-entity>

    <!-- NFT Marker -->
    <a-nft
            id="nyanMarker"
            type="nft"
            url="./nyan">

        <!-- Nyan Cat Image -->
        <a-plane
                id="nyanCard"
                position="0 0 0"
                rotation="-90 0 0"
                width="1.2"
                height="1.2"
                material="src: url(./nyan.png); transparent: true; opacity: 1;">
        </a-plane>

        <!-- Rainbow trail -->
        <a-box id="rainbow" visible="false"
               width="1.5"
               height="0.15"
               depth="0.15"
               position="0 0.2 0.2"
               material="color: #ff66ff; emissive: #ff33ff; opacity: 0.7; transparent: true"
               animation="property: position; to: 0 0.2 -0.5; loop: true; dur: 1200; dir: alternate">
        </a-box>

        <!-- Floating text -->
        <a-text id="text"
                value="âœ¨ Scan Nyan Cat!"
                color="#ffffff"
                align="center"
                width="2"
                position="0 0.9 0"
                rotation="-90 0 0">
        </a-text>

    </a-nft>

    <!-- Camera -->
    <a-entity camera></a-entity>

</a-scene>

<script>
    const marker = document.getElementById("nyanMarker");
    const nyanCard = document.getElementById("nyanCard");
    const rainbow = document.getElementById("rainbow");
    const text = document.getElementById("text");

    let visible = false;
    let clicked = false;

    marker.addEventListener('markerFound', () => {
        visible = true;
        text.setAttribute("value", "ðŸŒˆ Nyan Cat Appears! Tap the screen âœ¨");
    });

    marker.addEventListener('markerLost', () => {
        visible = false;
    });

    document.body.addEventListener('click', () => {
        if (!visible) return;

        if (!clicked) {
            rainbow.setAttribute("visible", true);
            text.setAttribute("value", "ðŸ’« Nyan Cat activates rainbow trail!");
            clicked = true;
        } else {
            rainbow.setAttribute("visible", false);
            text.setAttribute("value", "ðŸš€ Rainbow off. Tap again for magic!");
            clicked = false;
        }
    });
</script>

</body>
</html>
